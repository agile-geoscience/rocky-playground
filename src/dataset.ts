/* Copyright 2016 Google Inc. All Rights Reserved.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
==============================================================================*/

import * as d3 from 'd3';

/**
 * A two dimensional example: x and y coordinates with the label.
 */
export type Example2D = {
  x: number,
  y: number,
  label: number
};

type Point = {
  x: number,
  y: number
};

/**
 * Shuffles the array using Fisher-Yates algorithm. Uses the seedrandom
 * library as the random generator.
 */
export function shuffle(array: any[]): void {
  let counter = array.length;
  let temp = 0;
  let index = 0;
  // While there are elements in the array
  while (counter > 0) {
    // Pick a random index
    index = Math.floor(Math.random() * counter);
    // Decrease counter by 1
    counter--;
    // And swap the last element with it
    temp = array[counter];
    array[counter] = array[index];
    array[index] = temp;
  }
}

export type DataGenerator = (numSamples: number, noise: number) => Example2D[];

export function classifyTwoGaussData(numSamples: number, noise: number):
    Example2D[] {
  let points: Example2D[] = [];

  let varianceScale = d3.scale.linear().domain([0, .5]).range([0.5, 4]);
  let variance = varianceScale(noise);

  function genGauss(cx: number, cy: number, label: number) {
    for (let i = 0; i < numSamples / 2; i++) {
      let x = normalRandom(cx, variance);
      let y = normalRandom(cy, variance);
      points.push({x, y, label});
    }
  }

  genGauss(2, 2, 1); // Gaussian with positive examples.
  genGauss(-2, -2, -1); // Gaussian with negative examples.
  return points;
}

export function regressPlane(numSamples: number, noise: number):
  Example2D[] {
  let radius = 6;
  let labelScale = d3.scale.linear()
    .domain([-10, 10])
    .range([-1, 1]);
  let getLabel = (x, y) => labelScale(x + y);

  let points: Example2D[] = [];
  for (let i = 0; i < numSamples; i++) {
    let x = randUniform(-radius, radius);
    let y = randUniform(-radius, radius);
    let noiseX = randUniform(-radius, radius) * noise;
    let noiseY = randUniform(-radius, radius) * noise;
    let label = getLabel(x + noiseX, y + noiseY);
    points.push({x, y, label});
  }
  return points;
}

export function regressGaussian(numSamples: number, noise: number):
  Example2D[] {
  let points: Example2D[] = [];

  let labelScale = d3.scale.linear()
    .domain([0, 2])
    .range([1, 0])
    .clamp(true);

  let gaussians = [
    [-4, 2.5, 1],
    [0, 2.5, -1],
    [4, 2.5, 1],
    [-4, -2.5, -1],
    [0, -2.5, 1],
    [4, -2.5, -1]
  ];

  function getLabel(x, y) {
    // Choose the one that is maximum in abs value.
    let label = 0;
    gaussians.forEach(([cx, cy, sign]) => {
      let newLabel = sign * labelScale(dist({x, y}, {x: cx, y: cy}));
      if (Math.abs(newLabel) > Math.abs(label)) {
        label = newLabel;
      }
    });
    return label;
  }
  let radius = 6;
  for (let i = 0; i < numSamples; i++) {
    let x = randUniform(-radius, radius);
    let y = randUniform(-radius, radius);
    let noiseX = randUniform(-radius, radius) * noise;
    let noiseY = randUniform(-radius, radius) * noise;
    let label = getLabel(x + noiseX, y + noiseY);
    points.push({x, y, label});
  };
  return points;
}

export function classifyRocksData(numSamples: number, noise: number):
    Example2D[] {
  let positive = [{x: -1.9406011079922183, y: -2.535204590400754, label: 1.0},
    {x: -2.0655528434994626, y: -2.7137690540379498, label: 1.0},
    {x: -1.0576088437410252, y: -2.3176978767150165, label: 1.0},
    {x: -1.5249283345381182, y: -1.8152478699911967, label: 1.0},
    {x: 1.3689538598096596, y: 0.9135590663368393, label: 1.0},
    {x: 1.5955330068627969, y: 0.7881840174000846, label: 1.0},
    {x: 2.1894702563072306, y: 0.20025102276483983, label: 1.0},
    {x: -0.5719630984028687, y: -3.1212379630824088, label: 1.0},
    {x: -0.6102816306250909, y: -1.5720962599320336, label: 1.0},
    {x: -0.49782506866857096, y: -2.226516022942831, label: 1.0},
    {x: -0.8376937892482745, y: -1.7231162052422182, label: 1.0},
    {x: -1.0892632834028606, y: -2.8059007187869325, label: 1.0},
    {x: -1.1225837462047925, y: -2.0688474007950926, label: 1.0},
    {x: -1.1817275676782208, y: -1.7525603455228194, label: 1.0},
    {x: 1.7979548183845317, y: -1.876985583482781, label: 1.0},
    {x: -1.011793207388369, y: -3.4964132989158845, label: 1.0},
    {x: -1.8306435807458437, y: -2.4725170659323767, label: 1.0},
    {x: -0.35371406705021563, y: -1.7953018394785316, label: 1.0},
    {x: 4.61353392514777, y: -2.4763163098395475, label: 1.0},
    {x: -0.3437179282096363, y: -2.717568297945125, label: 1.0},
    {x: 0.7566903558241624, y: 0.9373043407566795, label: 1.0},
    {x: -0.9551484206250846, y: -2.311049199877463, label: 1.0},
    {x: 1.6796671754376726, y: 0.5317350536658102, label: 1.0},
    {x: -1.9406011079922183, y: -2.996812725122447, label: 1.0},
    {x: -1.493273894876284, y: -2.1866239619174968, label: 1.0},
    {x: -1.7989891410840082, y: -2.525706480632818, label: 1.0},
    {x: 2.212794580268582, y: 0.5165380780371134, label: 1.0},
    {x: -2.01307311458642, y: -2.8913837066983574, label: 1.0},
    {x: -1.7523404931613031, y: -2.8144490175780756, label: 1.0},
    {x: 1.7221507655101362, y: 0.20405026667201515, label: 1.0},
    {x: 2.259443228191287, y: 0.403510571798673, label: 1.0},
    {x: -1.6365518849245906, y: -1.748761101615644, label: 1.0},
    {x: -1.063439924731363, y: -2.7935531760886136, label: 1.0},
    {x: -0.32372565052847646, y: 0.3075796631425194, label: 1.0},
    {x: -0.4120248769535963, y: -2.2768560047128896, label: 1.0},
    {x: -0.5836252603835443, y: 0.036883534756340826, label: 1.0},
    {x: -1.0067951379680786, y: -2.146731900892167, label: 1.0},
    {x: -1.6515460931854602, y: -2.3081997669470806, label: 1.0},
    {x: -2.0330653922675785, y: -2.3471420169956176, label: 1.0},
    {x: -2.0655528434994626, y: -2.8277463712531827, label: 1.0},
    {x: -1.3649901130888458, y: -1.7383131808709151, label: 1.0},
    {x: 1.1706971061381661, y: 0.5155882670603206, label: 1.0},
    {x: -0.1904437993207492, y: -2.2664080839681606, label: 1.0},
    {x: 0.25438437908504, y: 0.20879932155598319, label: 1.0},
    {x: -1.1134206189342608, y: -2.8875844627911817, label: 1.0},
    {x: -2.0114070914463236, y: -3.006310834890383, label: 1.0},
    {x: 1.3689538598096596, y: 0.6409633159970752, label: 1.0},
    {x: 0.6850513608000085, y: 0.2363438398829987, label: 1.0},
    {x: -1.9264399113013977, y: -2.3328948523437134, label: 1.0},
    {x: -1.9347700270018806, y: -2.8011516639029646, label: 1.0},
    {x: -1.4924408833062353, y: -2.8296459932067726, label: 1.0},
    {x: 1.3289693044473423, y: -0.24141108144418832, label: 1.0},
    {x: 1.5955330068627969, y: -0.06474623976057792, label: 1.0},
    {x: 2.306091876113992, y: 0.6029708769253309, label: 1.0},
    {x: -0.14962623238838324, y: -2.7897539321814384, label: 1.0},
    {x: -0.8535210090791928, y: -1.6271852965860647, label: 1.0},
    {x: 6.032430299463367, y: -2.0052100653499183, label: 1.0},
    {x: -1.5374235080888425, y: -3.1962730302491047, label: 1.0},
    {x: -0.45950653644634887, y: -2.4392736817446004, label: 1.0},
    {x: 2.007873734036703, y: 0.32847550463197706, label: 1.0},
    {x: 1.852100570437671, y: 0.48044526091895445, label: 1.0},
    {x: 1.9403997968627906, y: 0.8233270235414464, label: 1.0},
    {x: 2.3768978595680967, y: 0.7359444136764361, label: 1.0},
    {x: 0.7566903558241624, y: 0.3398732363535029, label: 1.0},
    {x: 1.962891109254093, y: 0.22684573011506262, label: 1.0},
    {x: -1.2541995742724221, y: -2.0004610104659504, label: 1.0},
    {x: -1.919775818741011, y: -2.8837852188840065, label: 1.0},
    {x: -0.6927497760598715, y: -2.3471420169956176, label: 1.0},
    {x: 1.8087839687951586, y: 0.7197976270709465, label: 1.0},
    {x: 1.4297637044231841, y: 0.31232871802648743, label: 1.0},
    {x: -1.831476592315891, y: -2.3756363462994257, label: 1.0},
    {x: -0.8568530553593855, y: -2.489613663514659, label: 1.0},
    {x: -0.1946088571709907, y: -2.3794355902066013, label: 1.0},
    {x: -0.44034727033523785, y: -1.8494410651557656, label: 1.0},
    {x: 1.4705812713555526, y: 0.11761746778379759, label: 1.0},
    {x: -0.8901735181613174, y: -1.570196637978448, label: 1.0},
    {x: -1.8739601823883547, y: -1.5749456928624161, label: 1.0},
    {x: 1.852100570437671, y: 0.09482200434075011, label: 1.0},
    {x: -1.0517777627506875, y: -3.314999402348306, label: 1.0},
    {x: -0.7985422454560048, y: -1.579694747746384, label: 1.0},
    {x: 1.787125667973905, y: 0.512738834129938, label: 1.0},
    {x: 1.388946137490818, y: 0.9287560419655405, label: 1.0},
    {x: -0.8135364537168744, y: -2.134384358193848, label: 1.0},
    {x: 4.130387214519759, y: -2.3575899377403466, label: 1.0},
    {x: -0.8535210090791928, y: -1.5996407782590492, label: 1.0},
    {x: -1.67070535929657, y: -2.535204590400754, label: 1.0},
    {x: -1.1875586486685585, y: -3.066148926428382, label: 1.0},
    {x: 2.8975300908482815, y: -2.2977518462023516, label: 1.0},
    {x: -0.2545856902144677, y: -2.729915840643444, label: 1.0},
    {x: -0.38286947200190596, y: -1.8228463578055472, label: 1.0},
    {x: -0.6219437926057665, y: -2.180925096056736, label: 1.0},
    {x: -0.8301966851178403, y: 0.6580599135793619, label: 1.0},
    {x: -1.150906139586434, y: -2.767908279715188, label: 1.0},
    {x: 1.0165899656792317, y: 0.612468986693267, label: 1.0},
    {x: -1.3649901130888458, y: -1.9928625226516041, label: 1.0},
    {x: -1.0217893462289482, y: -1.6129381319341605, label: 1.0},
    {x: -1.4391281428231448, y: -2.4772661208163447, label: 1.0},
    {x: -1.894785471639562, y: -1.9073795347401792, label: 1.0},
    {x: -0.16462044064925282, y: -2.871437676185692, label: 1.0},
    {x: -1.544920612219278, y: -3.4232778537027784, label: 1.0},
    {x: 1.8962501836502295, y: -0.22811372776907693, label: 1.0},
    {x: -0.7310683082820937, y: -1.6955716869152027, label: 1.0},
    {x: -1.7573385625815934, y: -2.995862914145654, label: 1.0},
    {x: 1.9403997968627906, y: 0.5203373219442886, label: 1.0},
    {x: -1.0317854850695276, y: -1.5882430465375232, label: 1.0},
    {x: 1.701325476258929, y: 0.08817332750319658, label: 1.0},
    {x: -1.3730425582659795, y: 0.4728467731046082, label: 1.0},
    {x: 5.846391048819247, y: -2.6577302064071304, label: 1.0},
    {x: 2.1661459323458794, y: 0.7701376088410052, label: 1.0},
    {x: 1.2298409276115931, y: 0.23349440695261614, label: 1.0},
    {x: -1.9181097956009145, y: -2.6263864441729394, label: 1.0},
    {x: -1.3191744767361895, y: -2.9388742555380376, label: 1.0},
    {x: 1.5122318498579674, y: 0.25723968137245634, label: 1.0},
    {x: -0.27957603731591657, y: -2.305350334016698, label: 1.0},
    {x: 0.30436507328793777, y: 0.39306265105394417, label: 1.0},
    {x: 0.8666478830705372, y: 0.8670183284739559, label: 1.0},
    {x: 2.007873734036703, y: 0.8613194626131908, label: 1.0},
    {x: 0.13193167828794086, y: -3.0357549751709842, label: 1.0},
    {x: 2.212794580268582, y: -0.18632204479015727, label: 1.0},
    {x: 1.9853824216453981, y: 0.4092094376594338, label: 1.0},
    {x: -0.04216773985215238, y: -2.6748268039894127, label: 1.0},
    {x: -1.8414727311564705, y: -2.9027814384198787, label: 1.0},
    {x: -1.2647510541597011, y: -2.842943346881884, label: 1.0},
    {x: -0.7368993892724315, y: -2.9759168836329892, label: 1.0},
    {x: -0.7310683082820937, y: -1.9168776445081153, label: 1.0},
    {x: -1.5224292998279743, y: -2.907530493303847, label: 1.0},
    {x: 2.0295320348579566, y: 0.9354047188030941, label: 1.0},
    {x: 1.1706971061381661, y: 0.88126549312586, label: 1.0},
    {x: -1.4124717725815983, y: -2.5978921148691314, label: 1.0},
    {x: -0.08215229521447082, y: 0.023586181081229438, label: 1.0},
    {x: -0.38286947200190596, y: -2.3091495779238733, label: 1.0},
    {x: 1.4297637044231841, y: -0.08659189222682834, label: 1.0},
    {x: -1.8131503377748288, y: -2.6966724564556674, label: 1.0},
    {x: -1.988082767484971, y: -2.1543303887065175, label: 1.0},
    {x: 2.1661459323458794, y: 0.3180275838872482, label: 1.0},
    {x: -1.1200847114946473, y: -2.2179677241516877, label: 1.0},
    {x: -1.2600306552627614, y: -3.205771140017041, label: 1.0},
    {x: -0.010513300190318164, y: -2.654880773476748, label: 1.0},
    {x: -0.45367545545601107, y: -2.0992413520524864, label: 1.0},
    {x: 6.243459897208934, y: -2.748912060179316, label: 1.0},
    {x: 2.6531800303007818, y: -2.1847243399639114, label: 1.0},
    {x: 1.6588418861864653, y: 0.6343146391595217, label: 1.0},
    {x: -1.6823675212772469, y: -2.2977518462023516, label: 1.0},
    {x: -0.6902507413497264, y: -1.7402128028245005, label: 1.0},
    {x: -1.4699495709149315, y: -3.1620798350845356, label: 1.0},
    {x: -2.0580557393690273, y: -1.9064297237633823, label: 1.0},
    {x: -0.5677980405526273, y: -2.1182375715883586, label: 1.0},
    {x: -1.4699495709149315, y: -2.832495426137151, label: 1.0},
    {x: -1.8223134650453607, y: -3.464119725704903, label: 1.0},
    {x: -1.5790740865912574, y: -3.4061812561204916, label: 1.0},
    {x: 2.075347671210613, y: 0.6181678525540277, label: 1.0},
    {x: 6.004663247128423, y: -2.6415834198016364, label: 1.0},
    {x: -0.6277748735961043, y: -2.5703475965421156, label: 1.0},
    {x: 2.496851525655051, y: -0.25565824609609245, label: 1.0},
    {x: 2.1661459323458794, y: 0.3712169985876894, label: 1.0},
    {x: 1.787125667973905, y: 0.9002617126617322, label: 1.0},
    {x: -1.6482140469052662, y: -2.4886638525378664, label: 1.0},
    {x: -0.773551898354556, y: -2.494362718398627, label: 1.0},
    {x: 2.3535735356067455, y: 0.5678278707839691, label: 1.0},
    {x: 3.461201253247628, y: -2.6567803954303333, label: 1.0},
    {x: 0.9416189243748837, y: 0.6903534867903411, label: 1.0},
    {x: -0.6136136769052836, y: -2.3176978767150165, label: 1.0},
    {x: -1.8198144303352155, y: -3.1136394752680627, label: 1.0},
    {x: 1.787125667973905, y: 0.5288856207354277, label: 1.0},
    {x: -1.8772922286685474, y: -2.513358937934499, label: 1.0},
    {x: -1.4357960965429508, y: -1.9273255652528443, label: 1.0},
    {x: 1.553882428360382, y: 0.2904830655602327, label: 1.0},
    {x: -1.9297719575815904, y: -2.3518910718795856, label: 1.0},
    {x: 2.2361189042299356, y: -0.03910134338714789, label: 1.0},
    {x: -1.2616966784028576, y: -2.7916535541350282, label: 1.0},
    {x: -1.8389736964463266, y: -2.229365455873209, label: 1.0},
    {x: -1.5457536237893257, y: -1.6708766015185696, label: 1.0},
    {x: 2.448536854592251, y: 0.4462520657543854, label: 1.0},
    {x: -1.8273115344656496, y: -2.723267163805886, label: 1.0},
    {x: -1.1750634751178342, y: -2.6814754808269705, label: 1.0},
    {x: -0.3870345298521474, y: -2.3176978767150165, label: 1.0},
    {x: -0.7194061463014167, y: -1.7725063760354842, label: 1.0},
    {x: -0.9893018949970652, y: -3.2029217070866607, label: 1.0},
    {x: -1.1225837462047925, y: -2.1134885167043906, label: 1.0},
    {x: 0.5259461509207848, y: -0.2490095692585346, label: 1.0},
    {x: 0.11527144688697495, y: -2.470617443978787, label: 1.0},
    {x: 1.1706971061381661, y: 0.017887315220468648, label: 1.0},
    {x: -0.04216773985215238, y: -2.9901640482848935, label: 1.0},
    {x: -1.2375393428714563, y: -2.9996621580528293, label: 1.0},
    {x: 1.9853824216453981, y: 0.2515408155116956, label: 1.0},
    {x: -1.689864625407681, y: -2.0213568519554124, label: 1.0},
    {x: 0.9041334037227104, y: 0.8926632248473816, label: 1.0},
    {x: 1.0165899656792317, y: 0.46809771822064017, label: 1.0},
    {x: -1.2600306552627614, y: -2.533304968447164, label: 1.0},
    {x: 0.3718390104618502, y: 0.8774662492186848, label: 1.0},
    {x: 0.32907774986603744, y: -2.5276061025864034, label: 1.0},
    {x: 1.5955330068627969, y: 0.4671479072438431, label: 1.0},
    {x: -0.32872371994876676, y: -3.0509519507996807, label: 1.0},
    {x: 2.212794580268582, y: -0.10748773371629032, label: 1.0},
    {x: -0.27957603731591657, y: -2.4981619623058022, label: 1.0},
    {x: 0.06529075268407722, y: -2.4677680110484084, label: 1.0},
    {x: -0.5119862653593917, y: -1.8076493821768502, label: 1.0},
    {x: 1.3289693044473423, y: 0.8679681394507487, label: 1.0},
    {x: -0.37287333316132665, y: -2.419327651231931, label: 1.0},
    {x: -1.9830846980646806, y: -1.6661275466346017, label: 1.0},
];
  let negative = [{x: 3.3576301480382895, y: 3.2348970936204204, label: -1.0},
    {x: -0.8324180493046363, y: 3.03448697751697, label: -1.0},
    {x: -0.6572079490711438, y: 1.7569912137295658, label: -1.0},
    {x: -2.0980402947313457, y: 1.7892847869405493, label: -1.0},
    {x: -0.28457410673620687, y: 0.41205887058981633, label: -1.0},
    {x: 3.4503721028370014, y: 3.072479416588714, label: -1.0},
    {x: 1.8085062982718105, y: 1.5888746708370987, label: -1.0},
    {x: 0.20690271959228743, y: 1.9156096468540966, label: -1.0},
    {x: -1.9747545823641977, y: 2.1825065313331042, label: -1.0},
    {x: -3.7257449026057157, y: 0.11286841289982955, label: -1.0},
    {x: -4.283029642968025, y: -0.7904018260308917, label: -1.0},
    {x: 0.41265657739421613, y: 1.6392146526071574, label: -1.0},
    {x: -3.43030346576192, y: -0.48836193541052664, label: -1.0},
    {x: -0.5539145143851557, y: 1.526187146368717, label: -1.0},
    {x: -0.04910950293588817, y: 2.122668439795105, label: -1.0},
    {x: 0.016976081621275837, y: 2.9898458616076717, label: -1.0},
    {x: 0.6150783889159522, y: 2.3800672145061723, label: -1.0},
    {x: 4.2039699032073585, y: 1.8823662626663205, label: -1.0},
    {x: -0.20960306543186025, y: 1.875717585828767, label: -1.0},
    {x: 1.8446034663072366, y: 2.5643305440041333, label: -1.0},
    {x: -1.9339370154318318, y: 0.009339016429325301, label: -1.0},
    {x: -6.258100075552534, y: -1.1038394483727827, label: -1.0},
    {x: 4.016542299946492, y: 3.404913258466477, label: -1.0},
    {x: 1.8312752811864634, y: -0.630833581929568, label: -1.0},
    {x: 0.2929805818306113, y: 1.133915212952959, label: -1.0},
    {x: -1.406085350544562, y: 2.601373172099085, label: -1.0},
    {x: 2.7164889096244527, y: 1.428356615758978, label: -1.0},
    {x: 0.11860349316716762, y: 1.094023151927625, label: -1.0},
    {x: 2.0550777230061064, y: 2.5196894280948356, label: -1.0},
    {x: 3.680005625646981, y: 1.6135697562337317, label: -1.0},
    {x: -1.943933154272411, y: 2.262290653383764, label: -1.0},
    {x: 1.5960883479094952, y: 3.327978569346196, label: -1.0},
    {x: 4.375847957160656, y: 2.0713786470482494, label: -1.0},
    {x: -2.3757108180807776, y: 1.7949836528013101, label: -1.0},
    {x: 0.49151500602545506, y: 1.6724580367949338, label: -1.0},
    {x: 0.13470838352143516, y: 2.127417494679073, label: -1.0},
    {x: -4.0364582182337285, y: -0.9556689359929805, label: -1.0},
    {x: -2.4559575993287637, y: -0.912927442037268, label: -1.0},
    {x: -2.1227529713094455, y: -2.946472743352384, label: -1.0},
    {x: -1.414415466245045, y: 1.3504721156618993, label: -1.0},
    {x: -0.8396374829117212, y: 0.6542606696721867, label: -1.0},
    {x: -2.7866631926379366, y: 0.8432730540541157, label: -1.0},
    {x: -1.5152098662208882, y: 0.24109289476696674, label: -1.0},
    {x: 2.9103029349223566, y: 1.637315030653572, label: -1.0},
    {x: 0.7783486566454186, y: 3.643315813641672, label: -1.0},
    {x: 1.0704580472090204, y: 2.4646003914408046, label: -1.0},
    {x: 0.3065864374747337, y: 1.452101890178818, label: -1.0},
    {x: -1.9478205415993033, y: 0.9838450786195672, label: -1.0},
    {x: 3.469253698424761, y: 1.244093286261017, label: -1.0},
    {x: -2.000300270512346, y: 2.4589015255800435, label: -1.0},
    {x: -2.4992742009712745, y: 2.4541524706960756, label: -1.0},
    {x: -3.3667169159148997, y: -1.45052045490245, label: -1.0},
    {x: -0.023563814787740955, y: 1.8424742016409905, label: -1.0},
    {x: -1.7367909438537352, y: -0.1967699655348861, label: -1.0},
    {x: 0.13748508875492949, y: 1.5736776952083975, label: -1.0},
    {x: -0.7455071754962637, y: 2.485496232930262, label: -1.0},
    {x: -1.7398453196105788, y: 1.1899540605837828, label: -1.0},
    {x: 2.8581008765326628, y: 1.61641918916411, label: -1.0},
    {x: -1.6662626309229793, y: 2.252792543615828, label: -1.0},
    {x: -2.0644421614060646, y: 1.4739475426450686, label: -1.0},
    {x: -2.5975695662369738, y: -0.30789784981974094, label: -1.0},
    {x: 1.447812288440897, y: 1.9469534090882876, label: -1.0},
    {x: 2.711490840204162, y: 2.609921470890228, label: -1.0},
    {x: -0.878789026703991, y: 0.403510571798673, label: -1.0},
    {x: -0.04383376299224998, y: 2.4636505804640114, label: -1.0},
    {x: 0.4318158435053272, y: 2.5728788427952765, label: -1.0},
    {x: 4.163707677321691, y: 3.599624508709167, label: -1.0},
    {x: -1.0315078145461785, y: 0.06347824210655928, label: -1.0},
    {x: 3.076072237361967, y: 2.991745483561257, label: -1.0},
    {x: 1.1293241981590993, y: 2.9233590932321194, label: -1.0},
    {x: -1.0120708779117182, y: -1.440072534157721, label: -1.0},
    {x: 0.30269905014784143, y: 2.5491335683754364, label: -1.0},
    {x: -0.5344775777506955, y: 2.088475244630536, label: -1.0},
    {x: -0.02023176850754828, y: 2.0808767568161857, label: -1.0},
    {x: 0.25716108431853435, y: 3.2092521972469945, label: -1.0},
    {x: 0.37489338621869367, y: 1.5603803415332904, label: -1.0},
    {x: 3.548112127056001, y: 2.9689500201182097, label: -1.0},
    {x: 4.060969583682401, y: 3.774389728439192, label: -1.0},
    {x: -0.02828421368468079, y: 1.4008120974319624, label: -1.0},
    {x: 0.5317772319111227, y: 1.9953937689047607, label: -1.0},
    {x: -2.058888750939076, y: 0.2904830655602327, label: -1.0},
    {x: -1.028453438789335, y: 1.2203480118411767, label: -1.0},
    {x: -2.229933793322326, y: 0.8613194626131908, label: -1.0},
    {x: 4.091235670727488, y: 2.011540555510255, label: -1.0},
    {x: -2.4032001998923715, y: -0.15307866060238096, label: -1.0},
    {x: 2.5532186418949863, y: 1.0208877067145188, label: -1.0},
    {x: 1.2925944658885657, y: 1.894713805364639, label: -1.0},
    {x: -0.2082147128151131, y: 1.482495841436212, label: -1.0},
    {x: -1.883956321228934, y: 1.5955233476746522, label: -1.0},
    {x: -3.7076963185880025, y: -1.0098081616702188, label: -1.0},
    {x: -2.585907404256298, y: 0.5450324073409216, label: -1.0},
    {x: -1.4868874728392465, y: 0.34937134612143905, label: -1.0},
    {x: 0.5095635900431681, y: 1.9801967932760638, label: -1.0},
    {x: -0.22043221584248834, y: 2.7723391479219344, label: -1.0},
    {x: -0.8371384482015761, y: 1.0484322250415343, label: -1.0},
    {x: -1.2619743489262067, y: 0.20025102276483983, label: -1.0},
    {x: 3.688891082394162, y: 2.909111928580215, label: -1.0},
    {x: -2.77527870118061, y: -0.5225551305750957, label: -1.0},
    {x: 0.015865399527877855, y: 1.6116701342801418, label: -1.0},
    {x: -0.39564231607597955, y: 2.2546921655694177, label: -1.0},
    {x: -0.3678752637410364, y: 0.8841149260562383, label: -1.0},
    {x: -0.5655766763658313, y: 2.5690795988881012, label: -1.0},
    {x: -0.672757498378713, y: 2.0162896103942227, label: -1.0},
    {x: -1.8511911994737005, y: 2.3382755315272528, label: -1.0},
    {x: -2.433743957460809, y: 0.6143686086468525, label: -1.0},
    {x: 0.8966362995922763, y: 2.272738574128497, label: -1.0},
    {x: 0.12387923311080708, y: 2.536786025677118, label: -1.0},
    {x: 0.22994937303029078, y: 1.516689036600781, label: -1.0},
    {x: -1.7340142386202408, y: 1.1225174812314331, label: -1.0},
    {x: -1.245314117525241, y: 0.7682379868874197, label: -1.0},
    {x: 0.09028109978552608, y: 2.2746381960820825, label: -1.0},
    {x: 4.2275718976920595, y: 4.0944760276186365, label: -1.0},
    {x: -0.11408440539965546, y: 1.7028519880523318, label: -1.0},
    {x: -0.5927883876540762, y: 0.4386535779400348, label: -1.0},
    {x: 1.4622511556550697, y: 1.4046113413391377, label: -1.0},
    {x: 3.144656856629276, y: 0.9287560419655405, label: -1.0},
    {x: -2.3393359795220023, y: -2.134384358193848, label: -1.0},
    {x: -0.8565753848360363, y: 0.9287560419655405, label: -1.0},
    {x: -0.7713305341677613, y: 2.2793872509660504, label: -1.0},
    {x: -0.6510991975574568, y: -0.024854178735243756, label: -1.0},
    {x: -1.0651059478714593, y: -0.15592809353276352, label: -1.0},
    {x: -0.06799109852365004, y: 0.15560990685554194, label: -1.0},
    {x: -1.2591976436927124, y: 0.05208051038503771, label: -1.0},
    {x: 1.0562968505181982, y: 2.7580919832700306, label: -1.0},
    {x: -0.5761281562531102, y: 0.6219670964612031, label: -1.0},
    {x: -1.1947780822756449, y: 1.1187182373242623, label: -1.0},
    {x: -1.473003946671775, y: 0.40446038277546575, label: -1.0},
    {x: 2.178363435373253, y: 1.6781569026556944, label: -1.0},
    {x: -1.0648282773481101, y: -0.20721788627961926, label: -1.0},
    {x: 1.1482057937468613, y: 2.0105907445334577, label: -1.0},
    {x: -1.0853758960759685, y: 0.9790960237355991, label: -1.0},
    {x: -0.617778734755525, y: 0.1860038581129357, label: -1.0},
    {x: -3.1362503815348712, y: -1.5084589244868636, label: -1.0},
    {x: 1.7540828756953208, y: 3.345075166928478, label: -1.0},
    {x: 2.5037932887387866, y: 2.995544727468433, label: -1.0},
    {x: -1.3841493791999568, y: 2.1416646593309774, label: -1.0},
    {x: -3.6513292023480672, y: -0.2936506851678368, label: -1.0},
    {x: -1.4485689406170243, y: 1.5888746708370987, label: -1.0},
    {x: 2.4193814496405603, y: 2.877768166346024, label: -1.0},
    {x: -3.37171498533519, y: -0.3848325389400224, label: -1.0},
    {x: -0.9787504151097863, y: 2.074228079978632, label: -1.0},
    {x: 3.266831886903026, y: 2.693504836848063, label: -1.0},
    {x: -1.8423057427265193, y: 0.2876336326298544, label: -1.0},
    {x: 0.2635475063555718, y: 2.1046220312360258, label: -1.0},
    {x: -2.2524251057136295, y: 2.4864460439070593, label: -1.0},
    {x: 2.1925246320640754, y: 1.542333932974211, label: -1.0},
    {x: 1.6369059148418612, y: 1.8890149395038782, label: -1.0},
    {x: 0.46485863578390985, y: 1.9830462262064463, label: -1.0},
    {x: 0.08222865460839231, y: 2.8625711907173272, label: -1.0},
    {x: 2.4143833802202703, y: 1.9754477383920959, label: -1.0},
    {x: 3.9912742823216925, y: 1.5537316646957327, label: -1.0},
    {x: -5.754405746196664, y: -0.3648865084273575, label: -1.0},
    {x: 1.3009245815890487, y: 3.630018459966561, label: -1.0},
    {x: -1.8445271069133151, y: 0.41585811449699167, label: -1.0},
    {x: 1.849601535727527, y: 2.213850293567291, label: -1.0},
    {x: 3.9637849005101, y: 3.789586704067889, label: -1.0},
    {x: 1.1906893838193249, y: 1.6506123843286833, label: -1.0},
    {x: 1.9631687797774435, y: 2.8958145749051036, label: -1.0},
    {x: 1.3336897033442823, y: 1.049382036018327, label: -1.0},
    {x: -0.7899344592321728, y: -0.6792739417460412, label: -1.0},
    {x: 0.37628173883544086, y: 1.20325141425889, label: -1.0},
    {x: -1.9339370154318318, y: 0.023586181081229438, label: -1.0},
    {x: -0.6455457870904682, y: 1.1329654019761664, label: -1.0},
    {x: 4.274775886661463, y: 4.248345405859204, label: -1.0},
    {x: -1.0137369010518145, y: 0.7986319381448135, label: -1.0},
    {x: -0.7344003545622864, y: 1.0921235299740395, label: -1.0},
    {x: 0.5898103712911541, y: 1.622118055024875, label: -1.0},
    {x: 0.08445001879518826, y: 2.764740660107584, label: -1.0},
    {x: -1.0204009936122012, y: 0.35317059002861, label: -1.0},
    {x: 2.7981240434891843, y: 2.714400678337525, label: -1.0},
    {x: 3.9887752476115486, y: 4.06123264343086, label: -1.0},
    {x: 0.3499030391172448, y: 2.147363525191738, label: -1.0},
    {x: -2.095818930544551, y: 1.6648595489805873, label: -1.0},
    {x: -0.038280352525261345, y: 2.4589015255800435, label: -1.0},
    {x: -3.596905779771579, y: -1.0126575946005971, label: -1.0},
    {x: 0.43847993606571384, y: 2.5320369707931496, label: -1.0},
    {x: -2.3448893899889907, y: 2.4845464219534694, label: -1.0},
    {x: -0.4733900626138205, y: 1.4255071828285955, label: -1.0},
    {x: 3.8607691363474594, y: 1.7940338418245174, label: -1.0},
    {x: -1.4702272414382807, y: 0.4206071693809597, label: -1.0},
    {x: -1.8797912633786926, y: 2.7438448186181263, label: -1.0},
    {x: 1.5313911159690772, y: 3.0012435933291934, label: -1.0},
    {x: 3.425104085212202, y: 1.2155989569572085, label: -1.0},
    {x: -1.2689161120099426, y: 0.2477415716045203, label: -1.0},
    {x: 3.9873868949948013, y: 1.4701482987378975, label: -1.0},
    {x: -0.8404704944817688, y: 2.198653317938594, label: -1.0},
    {x: 3.929076085091421, y: 1.1928034935141612, label: -1.0},
    {x: -5.6916522079196925, y: -0.9841632652967888, label: -1.0},
    {x: 2.2361189042299356, y: 3.4277087219095246, label: -1.0},
    {x: -3.8509743086363093, y: -0.10273867883232228, label: -1.0},
    {x: -3.553589178129068, y: 0.06252843112976654, label: -1.0},
    {x: 1.17319614084831, y: -0.3610872645201822, label: -1.0},
    {x: 0.32880007934268823, y: 1.7892847869405493, label: -1.0},
    {x: -0.809371395866633, y: 0.15750952880912744, label: -1.0},
    {x: -2.0558343751822323, y: 0.6561602916257722, label: -1.0},
    {x: 4.2275718976920595, y: 3.853224039513059, label: -1.0},
    {x: -0.5789048614866046, y: 0.43485433403286383, label: -1.0},
    {x: 3.742759163923951, y: 2.7656904710843766, label: -1.0},
    {x: -1.1659003478473036, y: 1.8434240126177832, label: -1.0},
    {x: 3.70027557385149, y: 1.3818158778960903, label: -1.0},
];
  let n = numSamples / 2;
  let pos = positive.slice(0, n);
  let neg = negative.slice(0, n);
  let points: Example2D[] = pos.concat(neg);
  return points;
}

export function classifySpiralData(numSamples: number, noise: number):
    Example2D[] {
  let points: Example2D[] = [];
  let n = numSamples / 2;

  function genSpiral(deltaT: number, label: number) {
    for (let i = 0; i < n; i++) {
      let r = i / n * 5;
      let t = 1.75 * i / n * 2 * Math.PI + deltaT;
      let x = r * Math.sin(t) + randUniform(-1, 1) * noise;
      let y = r * Math.cos(t) + randUniform(-1, 1) * noise;
      points.push({x, y, label});
    }
  }

  genSpiral(0, 1); // Positive examples.
  genSpiral(Math.PI, -1); // Negative examples.
  return points;
}

export function classifyCircleData(numSamples: number, noise: number):
    Example2D[] {
  let points: Example2D[] = [];
  let radius = 5;
  function getCircleLabel(p: Point, center: Point) {
    return (dist(p, center) < (radius * 0.5)) ? 1 : -1;
  }

  // Generate positive points inside the circle.
  for (let i = 0; i < numSamples / 2; i++) {
    let r = randUniform(0, radius * 0.5);
    let angle = randUniform(0, 2 * Math.PI);
    let x = r * Math.sin(angle);
    let y = r * Math.cos(angle);
    let noiseX = randUniform(-radius, radius) * noise;
    let noiseY = randUniform(-radius, radius) * noise;
    let label = getCircleLabel({x: x + noiseX, y: y + noiseY}, {x: 0, y: 0});
    points.push({x, y, label});
  }

  // Generate negative points outside the circle.
  for (let i = 0; i < numSamples / 2; i++) {
    let r = randUniform(radius * 0.7, radius);
    let angle = randUniform(0, 2 * Math.PI);
    let x = r * Math.sin(angle);
    let y = r * Math.cos(angle);
    let noiseX = randUniform(-radius, radius) * noise;
    let noiseY = randUniform(-radius, radius) * noise;
    let label = getCircleLabel({x: x + noiseX, y: y + noiseY}, {x: 0, y: 0});
    points.push({x, y, label});
  }
  return points;
}

export function classifyXORData(numSamples: number, noise: number):
    Example2D[] {
  function getXORLabel(p: Point) { return p.x * p.y >= 0 ? 1 : -1; }

  let points: Example2D[] = [];
  for (let i = 0; i < numSamples; i++) {
    let x = randUniform(-5, 5);
    let padding = 0.3;
    x += x > 0 ? padding : -padding;  // Padding.
    let y = randUniform(-5, 5);
    y += y > 0 ? padding : -padding;
    let noiseX = randUniform(-5, 5) * noise;
    let noiseY = randUniform(-5, 5) * noise;
    let label = getXORLabel({x: x + noiseX, y: y + noiseY});
    points.push({x, y, label});
  }
  return points;
}

/**
 * Returns a sample from a uniform [a, b] distribution.
 * Uses the seedrandom library as the random generator.
 */
function randUniform(a: number, b: number) {
  return Math.random() * (b - a) + a;
}

/**
 * Samples from a normal distribution. Uses the seedrandom library as the
 * random generator.
 *
 * @param mean The mean. Default is 0.
 * @param variance The variance. Default is 1.
 */
function normalRandom(mean = 0, variance = 1): number {
  let v1: number, v2: number, s: number;
  do {
    v1 = 2 * Math.random() - 1;
    v2 = 2 * Math.random() - 1;
    s = v1 * v1 + v2 * v2;
  } while (s > 1);

  let result = Math.sqrt(-2 * Math.log(s) / s) * v1;
  return mean + Math.sqrt(variance) * result;
}

/** Returns the eucledian distance between two points in space. */
function dist(a: Point, b: Point): number {
  let dx = a.x - b.x;
  let dy = a.y - b.y;
  return Math.sqrt(dx * dx + dy * dy);
}
